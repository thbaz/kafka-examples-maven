<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Landing.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">scigility-kafka-streaming</a> &gt; <a href="index.source.html" class="el_package">ch.scigility.kafka.canonical</a> &gt; <span class="el_source">Landing.java</span></div><h1>Landing.java</h1><pre class="source lang-java linenums">package ch.scigility.kafka.canonical;

import java.io.*;
import java.util.*;
import java.text.SimpleDateFormat;
import java.text.ParseException;
import java.io.Serializable;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import com.fasterxml.jackson.annotation.JsonAnyGetter;
import com.fasterxml.jackson.annotation.JsonAnySetter;
import com.fasterxml.jackson.annotation.JsonIgnore;
import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.annotation.JsonProperty;
import com.fasterxml.jackson.annotation.JsonPropertyOrder;
import org.apache.commons.lang.builder.ToStringBuilder;

import ch.scigility.kafka.canonical.avro.ContractsSchema;

@JsonInclude(JsonInclude.Include.NON_NULL)
@JsonPropertyOrder({
    &quot;commandScn&quot;,
    &quot;commandCommitScn&quot;,
    &quot;commandSequence&quot;,
    &quot;commandType&quot;,
    &quot;commandTimestamp&quot;,
    &quot;objectDBName&quot;,
    &quot;objectSchemaName&quot;,
    &quot;objectId&quot;,
    &quot;changedFieldsList&quot;,
    &quot;conditionFieldsList&quot;
})

<span class="fc" id="L35">public class Landing implements Serializable</span>
{

    @JsonProperty(&quot;commandScn&quot;)
    private String commandScn;
    @JsonProperty(&quot;commandCommitScn&quot;)
    private String commandCommitScn;
    @JsonProperty(&quot;commandSequence&quot;)
    private String commandSequence;
    @JsonProperty(&quot;commandType&quot;)
    private String commandType;
    @JsonProperty(&quot;commandTimestamp&quot;)
    private String commandTimestamp;
    @JsonProperty(&quot;objectDBName&quot;)
    private String objectDBName;
    @JsonProperty(&quot;objectSchemaName&quot;)
    private String objectSchemaName;
    @JsonProperty(&quot;objectId&quot;)
    private String objectId;
<span class="fc" id="L54">    @JsonProperty(&quot;changedFieldsList&quot;)</span>
    private List&lt;ChangedFieldsList&gt; changedFieldsList = null;
<span class="fc" id="L56">    @JsonProperty(&quot;conditionFieldsList&quot;)</span>
    private List&lt;Object&gt; conditionFieldsList = null;
<span class="fc" id="L58">    @JsonIgnore</span>
    private Map&lt;String, Object&gt; additionalProperties = new HashMap&lt;String, Object&gt;();
    private final static long serialVersionUID = 8620905031372624204L;

    @JsonProperty(&quot;commandScn&quot;)
    public String getCommandScn() {
<span class="fc" id="L64">        return commandScn;</span>
    }

    @JsonProperty(&quot;commandScn&quot;)
    public void setCommandScn(String commandScn) {
<span class="fc" id="L69">        this.commandScn = commandScn;</span>
<span class="fc" id="L70">    }</span>

    public Landing withCommandScn(String commandScn) {
<span class="nc" id="L73">        this.commandScn = commandScn;</span>
<span class="nc" id="L74">        return this;</span>
    }

    @JsonProperty(&quot;commandCommitScn&quot;)
    public String getCommandCommitScn() {
<span class="fc" id="L79">        return commandCommitScn;</span>
    }

    @JsonProperty(&quot;commandCommitScn&quot;)
    public void setCommandCommitScn(String commandCommitScn) {
<span class="fc" id="L84">        this.commandCommitScn = commandCommitScn;</span>
<span class="fc" id="L85">    }</span>

    public Landing withCommandCommitScn(String commandCommitScn) {
<span class="nc" id="L88">        this.commandCommitScn = commandCommitScn;</span>
<span class="nc" id="L89">        return this;</span>
    }

    @JsonProperty(&quot;commandSequence&quot;)
    public String getCommandSequence() {
<span class="fc" id="L94">        return commandSequence;</span>
    }

    @JsonProperty(&quot;commandSequence&quot;)
    public void setCommandSequence(String commandSequence) {
<span class="fc" id="L99">        this.commandSequence = commandSequence;</span>
<span class="fc" id="L100">    }</span>

    public Landing withCommandSequence(String commandSequence) {
<span class="nc" id="L103">        this.commandSequence = commandSequence;</span>
<span class="nc" id="L104">        return this;</span>
    }

    @JsonProperty(&quot;commandType&quot;)
    public String getCommandType() {
<span class="fc" id="L109">        return commandType;</span>
    }

    @JsonProperty(&quot;commandType&quot;)
    public void setCommandType(String commandType) {
<span class="fc" id="L114">        this.commandType = commandType;</span>
<span class="fc" id="L115">    }</span>

    public Landing withCommandType(String commandType) {
<span class="nc" id="L118">        this.commandType = commandType;</span>
<span class="nc" id="L119">        return this;</span>
    }

    @JsonProperty(&quot;commandTimestamp&quot;)
    public String getCommandTimestamp() {
<span class="fc" id="L124">        return commandTimestamp;</span>
    }

    @JsonProperty(&quot;commandTimestamp&quot;)
    public void setCommandTimestamp(String commandTimestamp) {
<span class="fc" id="L129">        this.commandTimestamp = commandTimestamp;</span>
<span class="fc" id="L130">    }</span>

    public Landing withCommandTimestamp(String commandTimestamp) {
<span class="nc" id="L133">        this.commandTimestamp = commandTimestamp;</span>
<span class="nc" id="L134">        return this;</span>
    }

    @JsonProperty(&quot;objectDBName&quot;)
    public String getObjectDBName() {
<span class="fc" id="L139">        return objectDBName;</span>
    }

    @JsonProperty(&quot;objectDBName&quot;)
    public void setObjectDBName(String objectDBName) {
<span class="fc" id="L144">        this.objectDBName = objectDBName;</span>
<span class="fc" id="L145">    }</span>

    public Landing withObjectDBName(String objectDBName) {
<span class="nc" id="L148">        this.objectDBName = objectDBName;</span>
<span class="nc" id="L149">        return this;</span>
    }

    @JsonProperty(&quot;objectSchemaName&quot;)
    public String getObjectSchemaName() {
<span class="fc" id="L154">        return objectSchemaName;</span>
    }

    @JsonProperty(&quot;objectSchemaName&quot;)
    public void setObjectSchemaName(String objectSchemaName) {
<span class="fc" id="L159">        this.objectSchemaName = objectSchemaName;</span>
<span class="fc" id="L160">    }</span>

    public Landing withObjectSchemaName(String objectSchemaName) {
<span class="nc" id="L163">        this.objectSchemaName = objectSchemaName;</span>
<span class="nc" id="L164">        return this;</span>
    }

    @JsonProperty(&quot;objectId&quot;)
    public String getObjectId() {
<span class="fc" id="L169">        return objectId;</span>
    }

    @JsonProperty(&quot;objectId&quot;)
    public void setObjectId(String objectId) {
<span class="fc" id="L174">        this.objectId = objectId;</span>
<span class="fc" id="L175">    }</span>

    public Landing withObjectId(String objectId) {
<span class="nc" id="L178">        this.objectId = objectId;</span>
<span class="nc" id="L179">        return this;</span>
    }

    @JsonProperty(&quot;changedFieldsList&quot;)
    public List&lt;ChangedFieldsList&gt; getChangedFieldsList() {
<span class="fc" id="L184">        return changedFieldsList;</span>
    }

    @JsonProperty(&quot;changedFieldsList&quot;)
    public void setChangedFieldsList(List&lt;ChangedFieldsList&gt; changedFieldsList) {
<span class="fc" id="L189">        this.changedFieldsList = changedFieldsList;</span>
<span class="fc" id="L190">    }</span>

    public Landing withChangedFieldsList(List&lt;ChangedFieldsList&gt; changedFieldsList) {
<span class="nc" id="L193">        this.changedFieldsList = changedFieldsList;</span>
<span class="nc" id="L194">        return this;</span>
    }

    @JsonProperty(&quot;conditionFieldsList&quot;)
    public List&lt;Object&gt; getConditionFieldsList() {
<span class="fc" id="L199">        return conditionFieldsList;</span>
    }

    @JsonProperty(&quot;conditionFieldsList&quot;)
    public void setConditionFieldsList(List&lt;Object&gt; conditionFieldsList) {
<span class="fc" id="L204">        this.conditionFieldsList = conditionFieldsList;</span>
<span class="fc" id="L205">    }</span>

    public Landing withConditionFieldsList(List&lt;Object&gt; conditionFieldsList) {
<span class="nc" id="L208">        this.conditionFieldsList = conditionFieldsList;</span>
<span class="nc" id="L209">        return this;</span>
    }

    public ContractsSchema toAvroCanonical(){
<span class="fc" id="L213">      ContractsSchema contractsAvro = new ContractsSchema();</span>
<span class="fc" id="L214">      SimpleDateFormat f = new SimpleDateFormat(&quot;yyyy-MM-dd hh:mm:ss+00:000&quot;);</span>
      //getAdditionalProperties
<span class="fc bfc" id="L216" title="All 2 branches covered.">      for( ChangedFieldsList change: changedFieldsList ){</span>
<span class="pc bpc" id="L217" title="12 of 42 branches missed.">        switch(change.getFieldId()){</span>
          case &quot;COCO_ID&quot;:
<span class="fc" id="L219">            contractsAvro.put(0,new Long(change.getFieldValue()).longValue());</span>
<span class="fc" id="L220">            break;</span>
          case &quot;COCO_TYPE&quot;:
<span class="fc" id="L222">            contractsAvro.put(1,new Long(change.getFieldValue()).longValue());</span>
<span class="fc" id="L223">            break;</span>
          case &quot;COOC_COVERAGE&quot;:
<span class="fc" id="L225">            contractsAvro.put(2,new Long(change.getFieldValue()).longValue());</span>
<span class="fc" id="L226">            break;</span>
          case &quot;COCO_ANNUAL_PREMIUM&quot;:
<span class="fc" id="L228">            contractsAvro.put(3,new Long(change.getFieldValue()).longValue());</span>
<span class="fc" id="L229">            break;</span>
          case &quot;COCO_START_DATE&quot;:
            try {
<span class="fc" id="L232">                Date date = f.parse(change.getFieldValue());</span>
<span class="fc" id="L233">                long milliseconds = date.getTime();</span>
<span class="fc" id="L234">                contractsAvro.put(4,milliseconds);</span>
<span class="nc" id="L235">            } catch (ParseException e) {</span>
<span class="nc" id="L236">                e.printStackTrace();</span>
<span class="fc" id="L237">            }</span>
<span class="nc" id="L238">            break;</span>
          case &quot;COCO_END_DATE&quot;:
            try {
<span class="fc" id="L241">                Date date = f.parse(change.getFieldValue());</span>
<span class="fc" id="L242">                long milliseconds = date.getTime();</span>
<span class="fc" id="L243">                contractsAvro.put(5,milliseconds);</span>
<span class="nc" id="L244">            } catch (ParseException e) {</span>
<span class="nc" id="L245">                e.printStackTrace();</span>
<span class="fc" id="L246">            }</span>
<span class="nc" id="L247">            break;</span>
          case &quot;COCO_COCU_ID&quot;:
<span class="fc" id="L249">            contractsAvro.put(6,new Long(change.getFieldValue()).longValue());</span>
<span class="fc" id="L250">            break;</span>
          case &quot;COCO_COAG_ID&quot;:
<span class="fc" id="L252">            contractsAvro.put(7,new Long(change.getFieldValue()).longValue());</span>
<span class="fc" id="L253">            break;</span>
          case &quot;COCO_TOTAL_PAID_PREMIUMS&quot;:
<span class="fc" id="L255">            contractsAvro.put(8,new Long(change.getFieldValue()).longValue());</span>
<span class="fc" id="L256">            break;</span>
          case &quot;COCO_TOTAL_PAID_CLAIMS&quot;:
<span class="fc" id="L258">            contractsAvro.put(8,(java.lang.Long)contractsAvro.get(8)-new Long(change.getFieldValue()).longValue());</span>
            break;
        }
<span class="fc" id="L261">      }</span>
<span class="fc" id="L262">      return contractsAvro;</span>
    }

    @Override
    public String toString() {
<span class="fc" id="L267">        return ToStringBuilder.reflectionToString(this);</span>
    }

    @JsonAnyGetter
    public Map&lt;String, Object&gt; getAdditionalProperties() {
<span class="nc" id="L272">        return this.additionalProperties;</span>
    }

    @JsonAnySetter
    public void setAdditionalProperty(String name, Object value) {
<span class="nc" id="L277">        this.additionalProperties.put(name, value);</span>
<span class="nc" id="L278">    }</span>

    public Landing withAdditionalProperty(String name, Object value) {
<span class="nc" id="L281">        this.additionalProperties.put(name, value);</span>
<span class="nc" id="L282">        return this;</span>
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.7.201606060606</span></div></body></html>